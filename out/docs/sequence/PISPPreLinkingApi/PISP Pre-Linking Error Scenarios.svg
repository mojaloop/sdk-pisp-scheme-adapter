<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="1422px" preserveAspectRatio="none" style="width:1704px;height:1422px;" version="1.1" viewBox="0 0 1704 1422" width="1704px" zoomAndPan="magnify"><defs><filter height="300%" id="fp3egagbh766c" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><text fill="#000000" font-family="sans-serif" font-size="18" lengthAdjust="spacing" textLength="287" x="705" y="28.708">PISP Pre-Linking Error Scenarios</text><rect fill="#DDDDDD" height="1375.3672" style="stroke:#A80036;stroke-width:1.0;" width="871.5" x="445.5" y="40.9531"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="180" x="791.25" y="53.02">PISP tp-scheme-adapter</text><rect fill="#DDDDDD" height="1375.3672" style="stroke:#A80036;stroke-width:1.0;" width="73" x="1614" y="40.9531"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="67" x="1617" y="53.02">Mojaloop</text><rect fill="#FFFFFF" filter="url(#fp3egagbh766c)" height="1190.375" style="stroke:#A80036;stroke-width:1.0;" width="10" x="56.5" y="169.6484"/><rect fill="#FFFFFF" filter="url(#fp3egagbh766c)" height="1190.375" style="stroke:#A80036;stroke-width:1.0;" width="10" x="511.5" y="169.6484"/><rect fill="#FFFFFF" filter="url(#fp3egagbh766c)" height="100.3984" style="stroke:#A80036;stroke-width:1.0;" width="10" x="877.5" y="274.0469"/><rect fill="#FFFFFF" filter="url(#fp3egagbh766c)" height="213.1953" style="stroke:#A80036;stroke-width:1.0;" width="10" x="877.5" y="624.9063"/><rect fill="#FFFFFF" filter="url(#fp3egagbh766c)" height="213.1953" style="stroke:#A80036;stroke-width:1.0;" width="10" x="877.5" y="1117.6953"/><rect fill="#FFFFFF" filter="url(#fp3egagbh766c)" height="250.4609" style="stroke:#A80036;stroke-width:1.0;" width="10" x="1246.5" y="374.4453"/><rect fill="#FFFFFF" filter="url(#fp3egagbh766c)" height="250.4609" style="stroke:#A80036;stroke-width:1.0;" width="10" x="1246.5" y="867.2344"/><rect fill="#FFFFFF" filter="url(#fp3egagbh766c)" height="1023.7109" style="stroke:#A80036;stroke-width:1.0;" width="10" x="1645.5" y="345.3125"/><rect fill="#FFFFFF" filter="url(#fp3egagbh766c)" height="221.3281" style="stroke:#A80036;stroke-width:1.0;" width="10" x="1650.5" y="374.4453"/><rect fill="#FFFFFF" filter="url(#fp3egagbh766c)" height="221.3281" style="stroke:#A80036;stroke-width:1.0;" width="10" x="1650.5" y="867.2344"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="61" x2="61" y1="95.3828" y2="1378.0234"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="516.5" x2="516.5" y1="95.3828" y2="1378.0234"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="882.5" x2="882.5" y1="95.3828" y2="1378.0234"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="1251" x2="1251" y1="95.3828" y2="1378.0234"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="1650" x2="1650" y1="95.3828" y2="1378.0234"/><rect fill="#FEFECE" filter="url(#fp3egagbh766c)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="109" x="5" y="60.0859"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="95" x="12" y="80.0811">PISP Backend</text><rect fill="#FEFECE" filter="url(#fp3egagbh766c)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="109" x="5" y="1377.0234"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="95" x="12" y="1397.0186">PISP Backend</text><rect fill="#FEFECE" filter="url(#fp3egagbh766c)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="130" x="449.5" y="60.0859"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="116" x="456.5" y="80.0811">outbound-server</text><rect fill="#FEFECE" filter="url(#fp3egagbh766c)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="130" x="449.5" y="1377.0234"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="116" x="456.5" y="1397.0186">outbound-server</text><rect fill="#FEFECE" filter="url(#fp3egagbh766c)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="144" x="808.5" y="60.0859"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="130" x="815.5" y="80.0811">PISPrelinkingModel</text><rect fill="#FEFECE" filter="url(#fp3egagbh766c)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="144" x="808.5" y="1377.0234"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="130" x="815.5" y="1397.0186">PISPrelinkingModel</text><rect fill="#FEFECE" filter="url(#fp3egagbh766c)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="119" x="1190" y="60.0859"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="105" x="1197" y="80.0811">inbound-server</text><rect fill="#FEFECE" filter="url(#fp3egagbh766c)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="119" x="1190" y="1377.0234"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="105" x="1197" y="1397.0186">inbound-server</text><rect fill="#FEFECE" filter="url(#fp3egagbh766c)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="59" x="1619" y="60.0859"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="45" x="1626" y="80.0811">Switch</text><rect fill="#FEFECE" filter="url(#fp3egagbh766c)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="59" x="1619" y="1377.0234"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="45" x="1626" y="1397.0186">Switch</text><rect fill="#FFFFFF" filter="url(#fp3egagbh766c)" height="1190.375" style="stroke:#A80036;stroke-width:1.0;" width="10" x="56.5" y="169.6484"/><rect fill="#FFFFFF" filter="url(#fp3egagbh766c)" height="1190.375" style="stroke:#A80036;stroke-width:1.0;" width="10" x="511.5" y="169.6484"/><rect fill="#FFFFFF" filter="url(#fp3egagbh766c)" height="100.3984" style="stroke:#A80036;stroke-width:1.0;" width="10" x="877.5" y="274.0469"/><rect fill="#FFFFFF" filter="url(#fp3egagbh766c)" height="213.1953" style="stroke:#A80036;stroke-width:1.0;" width="10" x="877.5" y="624.9063"/><rect fill="#FFFFFF" filter="url(#fp3egagbh766c)" height="213.1953" style="stroke:#A80036;stroke-width:1.0;" width="10" x="877.5" y="1117.6953"/><rect fill="#FFFFFF" filter="url(#fp3egagbh766c)" height="250.4609" style="stroke:#A80036;stroke-width:1.0;" width="10" x="1246.5" y="374.4453"/><rect fill="#FFFFFF" filter="url(#fp3egagbh766c)" height="250.4609" style="stroke:#A80036;stroke-width:1.0;" width="10" x="1246.5" y="867.2344"/><rect fill="#FFFFFF" filter="url(#fp3egagbh766c)" height="1023.7109" style="stroke:#A80036;stroke-width:1.0;" width="10" x="1645.5" y="345.3125"/><rect fill="#FFFFFF" filter="url(#fp3egagbh766c)" height="221.3281" style="stroke:#A80036;stroke-width:1.0;" width="10" x="1650.5" y="374.4453"/><rect fill="#FFFFFF" filter="url(#fp3egagbh766c)" height="221.3281" style="stroke:#A80036;stroke-width:1.0;" width="10" x="1650.5" y="867.2344"/><rect fill="#EEEEEE" filter="url(#fp3egagbh766c)" height="3" style="stroke:#EEEEEE;stroke-width:1.0;" width="1697" x="0" y="125.9492"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="1697" y1="125.9492" y2="125.9492"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="1697" y1="128.9492" y2="128.9492"/><rect fill="#EEEEEE" filter="url(#fp3egagbh766c)" height="23.1328" style="stroke:#000000;stroke-width:2.0;" width="102" x="797.5" y="115.3828"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="83" x="803.5" y="131.4497">Pre-Linking</text><polygon fill="#A80036" points="499.5,165.6484,509.5,169.6484,499.5,173.6484,503.5,169.6484" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="66.5" x2="505.5" y1="169.6484" y2="169.6484"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="102" x="73.5" y="164.5825">PRELINKING-1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="136" x="179.5" y="164.5825">GET /linking/providers</text><line style="stroke:#A80036;stroke-width:1.0;" x1="521.5" x2="563.5" y1="198.7813" y2="198.7813"/><line style="stroke:#A80036;stroke-width:1.0;" x1="563.5" x2="563.5" y1="198.7813" y2="211.7813"/><line style="stroke:#A80036;stroke-width:1.0;" x1="522.5" x2="563.5" y1="211.7813" y2="211.7813"/><polygon fill="#A80036" points="532.5,207.7813,522.5,211.7813,532.5,215.7813,528.5,211.7813" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="102" x="528.5" y="193.7153">PRELINKING-2</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="186" x="634.5" y="193.7153">const model = await create()</text><rect fill="#FBFB77" filter="url(#fp3egagbh766c)" height="23" style="stroke:#A80036;stroke-width:1.0;" width="79" x="526" y="224.7813"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="71" x="530" y="240.8481">state: start</text><polygon fill="#A80036" points="865.5,270.0469,875.5,274.0469,865.5,278.0469,869.5,274.0469" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="521.5" x2="871.5" y1="274.0469" y2="274.0469"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="102" x="528.5" y="268.981">PRELINKING-3</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="231" x="634.5" y="268.981">model.getThirdpartyEnabledDFSPs()</text><line style="stroke:#A80036;stroke-width:1.0;" x1="887.5" x2="929.5" y1="303.1797" y2="303.1797"/><line style="stroke:#A80036;stroke-width:1.0;" x1="929.5" x2="929.5" y1="303.1797" y2="316.1797"/><line style="stroke:#A80036;stroke-width:1.0;" x1="888.5" x2="929.5" y1="316.1797" y2="316.1797"/><polygon fill="#A80036" points="898.5,312.1797,888.5,316.1797,898.5,320.1797,894.5,316.1797" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="102" x="894.5" y="298.1138">PRELINKING-4</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="239" x="1000.5" y="298.1138">ThirdpartyRequests.getServicesById()</text><polygon fill="#A80036" points="1633.5,341.3125,1643.5,345.3125,1633.5,349.3125,1637.5,345.3125" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="887.5" x2="1639.5" y1="345.3125" y2="345.3125"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="102" x="894.5" y="340.2466">PRELINKING-5</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="214" x="1000.5" y="340.2466">GET /services/THIRD_PARTY_DFSP</text><polygon fill="#A80036" points="893.5,370.4453,883.5,374.4453,893.5,378.4453,889.5,374.4453" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="887.5" x2="1649.5" y1="374.4453" y2="374.4453"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="102" x="899.5" y="369.3794">PRELINKING-6</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="88" x="1005.5" y="369.3794">202 Accepted</text><path d="M20,387.4453 L20,412.4453 L1692,412.4453 L1692,397.4453 L1682,387.4453 L20,387.4453 " fill="#FBFB77" filter="url(#fp3egagbh766c)" style="stroke:#A80036;stroke-width:1.0;"/><path d="M1682,387.4453 L1682,397.4453 L1692,397.4453 L1682,387.4453 " fill="#FBFB77" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="296" x="701.5" y="404.5122">ERROR_SCENARIO: Switch receives 7201 error.</text><polygon fill="#A80036" points="1267.5,438.7109,1257.5,442.7109,1267.5,446.7109,1263.5,442.7109" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="1261.5" x2="1649.5" y1="442.7109" y2="442.7109"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="102" x="1273.5" y="437.645">PRELINKING-7</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="249" x="1379.5" y="437.645">PUT /services/THIRD_PARTY_DFSP/error</text><rect fill="#F08080" filter="url(#fp3egagbh766c)" height="113" style="stroke:#A80036;stroke-width:1.0;" width="348" x="1292" y="455.7109"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="249" x="1296" y="471.7778">PUT /services/THIRD_PARTY_DFSP/error</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="8" x="1296" y="486.9106">{</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="120" x="1304" y="502.0435">errorInformation: {</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="114" x="1312" y="517.1763">errorCode: '7201',</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="324" x="1312" y="532.3091">errorDescription: 'No thirdparty enabled FSP found'</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="8" x="1304" y="547.4419">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="8" x="1296" y="562.5747">}</text><polygon fill="#A80036" points="1633.5,591.7734,1643.5,595.7734,1633.5,599.7734,1637.5,595.7734" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="1256.5" x2="1639.5" y1="595.7734" y2="595.7734"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="102" x="1263.5" y="590.7075">PRELINKING-8</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="46" x="1369.5" y="590.7075">200 OK</text><polygon fill="#A80036" points="898.5,620.9063,888.5,624.9063,898.5,628.9063,894.5,624.9063" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="892.5" x2="1250.5" y1="624.9063" y2="624.9063"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="102" x="904.5" y="619.8403">PRELINKING-9</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="203" x="1010.5" y="619.8403">ErrorInformationObject recieved</text><line style="stroke:#A80036;stroke-width:1.0;" x1="887.5" x2="929.5" y1="654.0391" y2="654.0391"/><line style="stroke:#A80036;stroke-width:1.0;" x1="929.5" x2="929.5" y1="654.0391" y2="667.0391"/><line style="stroke:#A80036;stroke-width:1.0;" x1="888.5" x2="929.5" y1="667.0391" y2="667.0391"/><polygon fill="#A80036" points="898.5,663.0391,888.5,667.0391,898.5,671.0391,894.5,667.0391" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="111" x="894.5" y="648.9731">PRELINKING-10</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="110" x="1009.5" y="648.9731">throw same error</text><rect fill="#F08080" filter="url(#fp3egagbh766c)" height="98" style="stroke:#A80036;stroke-width:1.0;" width="348" x="892" y="680.0391"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="8" x="896" y="696.106">{</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="120" x="904" y="711.2388">errorInformation: {</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="114" x="912" y="726.3716">errorCode: '7201',</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="324" x="912" y="741.5044">errorDescription: 'No thirdparty enabled FSP found'</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="8" x="904" y="756.6372">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="8" x="896" y="771.77">}</text><rect fill="#FBFB77" filter="url(#fp3egagbh766c)" height="23" style="stroke:#A80036;stroke-width:1.0;" width="96" x="892" y="788.8359"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="88" x="896" y="804.9028">state: errored</text><polygon fill="#A80036" points="532.5,834.1016,522.5,838.1016,532.5,842.1016,528.5,838.1016" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="526.5" x2="881.5" y1="838.1016" y2="838.1016"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="111" x="538.5" y="833.0356">PRELINKING-11</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="172" x="653.5" y="833.0356">catch MojaloopFSPIOPError</text><polygon fill="#A80036" points="77.5,863.2344,67.5,867.2344,77.5,871.2344,73.5,867.2344" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="71.5" x2="510.5" y1="867.2344" y2="867.2344"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="111" x="83.5" y="862.1685">PRELINKING-12</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="243" x="198.5" y="862.1685">404 Not Found ErrorInformationObject</text><path d="M20,880.2344 L20,905.2344 L1692,905.2344 L1692,890.2344 L1682,880.2344 L20,880.2344 " fill="#FBFB77" filter="url(#fp3egagbh766c)" style="stroke:#A80036;stroke-width:1.0;"/><path d="M1682,880.2344 L1682,890.2344 L1692,890.2344 L1682,880.2344 " fill="#FBFB77" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="344" x="677.5" y="897.3013">ERROR_SCENARIO: Switch sends back any other error.</text><polygon fill="#A80036" points="1267.5,931.5,1257.5,935.5,1267.5,939.5,1263.5,935.5" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="1261.5" x2="1649.5" y1="935.5" y2="935.5"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="111" x="1273.5" y="930.4341">PRELINKING-13</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="249" x="1388.5" y="930.4341">PUT /services/THIRD_PARTY_DFSP/error</text><rect fill="#F08080" filter="url(#fp3egagbh766c)" height="113" style="stroke:#A80036;stroke-width:1.0;" width="268" x="1372" y="948.5"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="249" x="1376" y="964.5669">PUT /services/THIRD_PARTY_DFSP/error</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="8" x="1376" y="979.6997">{</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="120" x="1384" y="994.8325">errorInformation: {</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="114" x="1392" y="1009.9653">errorCode: '2001',</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="244" x="1392" y="1025.0981">errorDescription: 'Internal server error'</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="8" x="1384" y="1040.231">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="8" x="1376" y="1055.3638">}</text><polygon fill="#A80036" points="1633.5,1084.5625,1643.5,1088.5625,1633.5,1092.5625,1637.5,1088.5625" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="1256.5" x2="1639.5" y1="1088.5625" y2="1088.5625"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="111" x="1263.5" y="1083.4966">PRELINKING-14</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="46" x="1378.5" y="1083.4966">200 OK</text><polygon fill="#A80036" points="898.5,1113.6953,888.5,1117.6953,898.5,1121.6953,894.5,1117.6953" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="892.5" x2="1250.5" y1="1117.6953" y2="1117.6953"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="111" x="904.5" y="1112.6294">PRELINKING-15</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="165" x="1019.5" y="1112.6294">Services request recieved</text><line style="stroke:#A80036;stroke-width:1.0;" x1="887.5" x2="929.5" y1="1146.8281" y2="1146.8281"/><line style="stroke:#A80036;stroke-width:1.0;" x1="929.5" x2="929.5" y1="1146.8281" y2="1159.8281"/><line style="stroke:#A80036;stroke-width:1.0;" x1="888.5" x2="929.5" y1="1159.8281" y2="1159.8281"/><polygon fill="#A80036" points="898.5,1155.8281,888.5,1159.8281,898.5,1163.8281,894.5,1159.8281" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="111" x="894.5" y="1141.7622">PRELINKING-16</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="220" x="1009.5" y="1141.7622">throw account linking generic error</text><rect fill="#F08080" filter="url(#fp3egagbh766c)" height="98" style="stroke:#A80036;stroke-width:1.0;" width="392" x="892" y="1172.8281"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="8" x="896" y="1188.895">{</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="120" x="904" y="1204.0278">errorInformation: {</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="114" x="912" y="1219.1606">errorCode: '7200',</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="368" x="912" y="1234.2935">errorDescription: 'Generic Thirdparty account linking error'</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="8" x="904" y="1249.4263">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="8" x="896" y="1264.5591">}</text><rect fill="#FBFB77" filter="url(#fp3egagbh766c)" height="23" style="stroke:#A80036;stroke-width:1.0;" width="96" x="892" y="1281.625"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="88" x="896" y="1297.6919">state: errored</text><polygon fill="#A80036" points="532.5,1326.8906,522.5,1330.8906,532.5,1334.8906,528.5,1330.8906" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="526.5" x2="881.5" y1="1330.8906" y2="1330.8906"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="111" x="538.5" y="1325.8247">PRELINKING-17</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="172" x="653.5" y="1325.8247">catch MojaloopFSPIOPError</text><polygon fill="#A80036" points="72.5,1356.0234,62.5,1360.0234,72.5,1364.0234,68.5,1360.0234" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="66.5" x2="515.5" y1="1360.0234" y2="1360.0234"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="111" x="78.5" y="1354.9575">PRELINKING-18</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="306" x="193.5" y="1354.9575">500 Internal Server Error ErrorInformationObject</text><!--MD5=[a7548d87f43ac40a5bf10208fdc789ae]
@startuml

title PISP Pre-Linking Error Scenarios

participant "PISP Backend" as PISP
box "PISP tp-scheme-adapter"
  participant "outbound-server" as PISP_TP_OUT
  participant "PISPrelinkingModel" as PISP_PLM
  participant "inbound-server" as PISP_TP_IN
end box
box "Mojaloop"
    participant Switch
end box

== Pre-Linking ==
autonumber 1 "<b>PRELINKING-#</b>"

PISP -> PISP_TP_OUT: GET /linking/providers

activate PISP
activate PISP_TP_OUT

PISP_TP_OUT -> PISP_TP_OUT: const model = await create()
rnote right of PISP_TP_OUT: state: start
PISP_TP_OUT -> PISP_PLM: model.getThirdpartyEnabledDFSPs()

activate PISP_PLM

PISP_PLM -> PISP_PLM: ThirdpartyRequests.getServicesById()
PISP_PLM -> Switch: GET /services/THIRD_PARTY_DFSP

activate Switch
Switch - -> PISP_PLM: 202 Accepted
deactivate PISP_PLM

note over PISP, Switch
  ERROR_SCENARIO: Switch receives 7201 error.
end note

activate PISP_TP_IN
activate Switch

Switch - -> PISP_TP_IN: PUT /services/THIRD_PARTY_DFSP/error
rnote left of Switch #LightCoral
PUT /services/THIRD_PARTY_DFSP/error
{
  errorInformation: {
    errorCode: '7201',
    errorDescription: 'No thirdparty enabled FSP found'
  }
}
end note
PISP_TP_IN - -> Switch: 200 OK

deactivate Switch

PISP_TP_IN -> PISP_PLM: ErrorInformationObject recieved

deactivate PISP_TP_IN
activate PISP_PLM

PISP_PLM -> PISP_PLM: throw same error
rnote right of PISP_PLM #LightCoral
{
  errorInformation: {
    errorCode: '7201',
    errorDescription: 'No thirdparty enabled FSP found'
  }
}
end note
rnote right of PISP_PLM: state: errored
PISP_PLM -> PISP_TP_OUT: catch MojaloopFSPIOPError

deactivate PISP_PLM

PISP_TP_OUT - -> PISP: 404 Not Found ErrorInformationObject


note over PISP, Switch
  ERROR_SCENARIO: Switch sends back any other error.
end note

activate PISP_TP_IN
activate Switch
Switch - -> PISP_TP_IN: PUT /services/THIRD_PARTY_DFSP/error
rnote left of Switch #LightCoral
PUT /services/THIRD_PARTY_DFSP/error
{
  errorInformation: {
    errorCode: '2001',
    errorDescription: 'Internal server error'
  }
}
end note
PISP_TP_IN - -> Switch: 200 OK

deactivate Switch

PISP_TP_IN -> PISP_PLM: Services request recieved

deactivate PISP_TP_IN
activate PISP_PLM

PISP_PLM -> PISP_PLM: throw account linking generic error
rnote right of PISP_PLM #LightCoral
{
  errorInformation: {
    errorCode: '7200',
    errorDescription: 'Generic Thirdparty account linking error'
  }
}
end note
rnote right of PISP_PLM: state: errored
PISP_PLM -> PISP_TP_OUT: catch MojaloopFSPIOPError

deactivate PISP_PLM

PISP_TP_OUT - -> PISP: 500 Internal Server Error ErrorInformationObject

deactivate PISP_TP_OUT
deactivate PISP

@enduml

PlantUML version 1.2021.00(Sun Jan 10 05:25:05 EST 2021)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Default Encoding: UTF-8
Language: en
Country: US
--></g></svg>